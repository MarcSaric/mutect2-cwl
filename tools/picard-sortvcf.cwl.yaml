#!/usr/bin/env cwl-runner

description: |
  Usage:  cwl-runner /path/to/picard-sortvcf.cwl.yaml --vcf_path /path/to/vcf --reference_fasta_dict /path/to/Homo_sapiens_assembly38.dict --case_id case_id --output_vcf output_name --postgres_config postgres_config
  Options:
    --vcf_path             VCF file path
    --reference_fasta_dict Homo_sapiens_assembly38.dict
    --case_id              case_id
    --output_vcf           sorted_vcf_name
    --postgres_config      postgres_config

requirements:
  - import: node-engine.cwl
  - import: envvar-global.cwl
  - class: DockerRequirement
    dockerPull: quay.io/shenglai/picard-sortvcf-tool:0.16c

class: CommandLineTool

inputs:
  - id: "#vcf_path"
    type: File
    inputBinding:
      prefix: --vcf_path

  - id: "#output_vcf"
    type: string
    inputBinding:
        prefix: --output_vcf

  - id: "#reference_fasta_dict"
    type: File
    inputBinding:
      prefix: --reference_fasta_dict

  - id: "#case_id"
    type: string
    inputBinding:
      prefix: --case_id

  - id: "#postgres_config"
    type: File
    inputBinding:
      prefix: --postgres_config

  - id: "#host"
    type: string
    inputBinding:
      prefix: --host
      
outputs:
  - id: "#srt_vcf"
    type: File
    description: "sorted vcf file"
    outputBinding:
      glob:
        engine: node-engine.cwl
        script: |
          {
            return $job['output_vcf']
          }

  - id: "#log"
    type: File
    description: "python log file"
    outputBinding:
      glob:
        engine: node-engine.cwl
        script: |
          {
          return $job['case_id']+"_picard_sortvcf.log"
          }

baseCommand: ["/home/ubuntu/.virtualenvs/p3/bin/python","/home/ubuntu/tools/picard_tool/main.py"]
